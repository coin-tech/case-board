<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>接案板 MVP</title><!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
    body { padding: 20px; }
    .case { margin-bottom: 20px; }
    .card-text {
        white-space: pre-line;
    }
    .alert-fixed {
        position: sticky;
        top: 0;
        z-index: 1000;
    }
</style>
</head>
<body>

<div class="container">
    <!-- 安全提醒區 -->
    <div class="alert alert-warning alert-fixed text-center" role="alert">
        ⚠️ 注意安全：本平台僅提供公開接案資訊，不介入交易或合作風險。
        請自行審核案主與案件，避免任何詐騙或財務損失。
    </div>

    <h1 class="mb-4">接案板 MVP</h1>

    <a href="https://go2.idv.tw/44Q12E" target="_blank">由此發案</a>
    <div id="cases" class="row row-cols-1 row-cols-md-2 g-4"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
const sheetCSV = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSRPzfYS3cocpBgFVUCe8uAXDc4orPZgdC-ijxinhoMObm0ccFsyvpWtI0pIrmSgkM5Q4vcg1C8Ue80/pub?gid=1304270105&single=true&output=csv';

Papa.parse(sheetCSV, {
    download: true,
    header: true,
    complete: function(results) {
        const data = results.data;
        // 排序，最新在前
        data.sort((a, b) => parseTime(b['時間戳記']) - parseTime(a['時間戳記']));
        const container = document.getElementById('cases');
        data.forEach(item => {
            // 過濾空案
            if (!item['案名']) return;
            // 判斷截止日期
            const today = new Date();
            const deadline = new Date(item['截止日期']);
            if (deadline < today) return;

            const div = document.createElement('div');
            div.className = 'col';
            div.innerHTML = `
                    <div class="card h-100 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">${item['案名']}</h5>
                            <p class="card-text"><strong>發佈時間:</strong> ${item['時間戳記']}</p>
                            <p class="card-text"><strong>描述:</strong> ${item['描述']}</p>
                            <p class="card-text"><strong>類別:</strong> ${item['類別']}</p>
                            <p class="card-text"><strong>預算:</strong> ${item['預算']}</p>
                            <p class="card-text"><strong>截止日期:</strong> ${item['截止日期']}</p>
                            <p class="card-text"><strong>聯絡方式:</strong> ${item['聯絡方式']}</p>
                        </div>
                    </div>
                `;
            container.appendChild(div);
        });
    }
});

// 先把上午/下午轉成24小時制
function parseTime(str) {
    let [datePart, timePart, hhmmss] = str.split(' ');
    let isPM = timePart.includes('下午');
    let [h, m, s] = hhmmss.split(':').map(Number);

    if (isPM && h < 12) h += 12;
    if (!isPM && h === 12) h = 0;

    return new Date(`${datePart} ${h.toString().padStart(2, '0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`);
}
</script>

<!-- Footer -->
<footer class="bg-light text-center text-muted py-3 mt-4">
    © 2025 科云科技股份有限公司 | LINE: @919ktlqo | 本平台不負責交易風險，請自行審核案件與聯絡方式
</footer>

<!-- Bootstrap 5 JS (可選) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
